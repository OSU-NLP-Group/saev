
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://osu-nlp-group.github.io/saev/api/users/sweeps/">
      
      
        <link rel="prev" href="../glossary/">
      
      
        <link rel="next" href="../../developers/contributing/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Sweeps - saev</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sweeps" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="saev" class="md-header__button md-logo" aria-label="saev" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            saev
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Sweeps
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../guide/" class="md-tabs__link">
          
  
  
    
  
  Users

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../developers/contributing/" class="md-tabs__link">
          
  
  
    
  
  Developers

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api/saev/" class="md-tabs__link">
          
  
  
    
  
  API

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="saev" class="md-nav__button md-logo" aria-label="saev" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    saev
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Users
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Users
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../inference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Sweeps
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Sweeps
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      Quick Start
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-parallel-sweeps" class="md-nav__link">
    <span class="md-ellipsis">
      Why Parallel Sweeps?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sweep-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Sweep Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sweep Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python-based-sweeps" class="md-nav__link">
    <span class="md-ellipsis">
      Python-Based Sweeps
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-line-overrides" class="md-nav__link">
    <span class="md-ellipsis">
      Command-Line Overrides
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parallel-groups" class="md-nav__link">
    <span class="md-ellipsis">
      Parallel Groups
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-loading" class="md-nav__link">
    <span class="md-ellipsis">
      Module Loading
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#slurm-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Slurm Integration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seed-management" class="md-nav__link">
    <span class="md-ellipsis">
      Seed Management
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Developers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Developers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/protocol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Shard Protocol
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/disk-layout/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Disk Layout
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/saev/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/colors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.colors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/configs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.configs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/data/saev.data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/data/buffers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.data.buffers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/data/clip/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.data.clip
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/data/datasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.data.datasets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/data/dinov2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.data.dinov2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/data/dinov3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.data.dinov3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/data/fake_clip/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.data.fake_clip
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/data/indexed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.data.indexed
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/data/models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.data.models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/data/ordered/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.data.ordered
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/data/shards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.data.shards
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/data/shuffled/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.data.shuffled
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/data/siglip/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.data.siglip
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/data/transforms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.data.transforms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/disk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.disk
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/framework/saev.framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.framework
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/framework/inference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.framework.inference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/framework/shards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.framework.shards
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.helpers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/nn/saev.nn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.nn
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/nn/modeling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.nn.modeling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/nn/objectives/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.nn.objectives
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/utils/saev.utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/utils/scheduling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.utils.scheduling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/utils/statistics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.utils.statistics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/utils/wandb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.utils.wandb
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/viz/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    saev.viz
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="sweeps">Sweeps<a class="headerlink" href="#sweeps" title="Permanent link">&para;</a></h1>
<p>Hyperparameter sweeps in <code>saev</code> train multiple SAE configurations in parallel on a single GPU, amortizing the cost of loading activation data from disk across all models.
Furthermore, sweeps make it easy to train multiple SAEs with one command across multiple GPUs using Slurm.</p>
<h2 id="quick-start">Quick Start<a class="headerlink" href="#quick-start" title="Permanent link">&para;</a></h2>
<p>Create a Python file defining your sweep:</p>
<pre><code class="language-python"># sweeps/my_sweep.py

def make_cfgs() -&gt; list[dict]:
    cfgs = []

    # Grid search over learning rate and sparsity
    for lr in [3e-4, 1e-3, 3e-3]:
        for sparsity in [4e-4, 8e-4, 1.6e-3]:
            cfg = {
                &quot;lr&quot;: lr,
                &quot;objective&quot;: {&quot;sparsity_coeff&quot;: sparsity},
            }
            cfgs.append(cfg)

    return cfgs
</code></pre>
<p>Run the sweep:</p>
<pre><code class="language-bash">uv run train.py --sweep sweeps/my_sweep.py \
  --train-data.layer 23 \
  --val-data.layer 23
</code></pre>
<p>This trains 9 SAEs (3 learning rates x 3 sparsity coefficients) in parallel.</p>
<h2 id="why-parallel-sweeps">Why Parallel Sweeps?<a class="headerlink" href="#why-parallel-sweeps" title="Permanent link">&para;</a></h2>
<p>SAE training is bottlenecked by disk I/O, not GPU computation. Loading terabytes of pre-computed ViT activations from disk is the slowest part. By training multiple SAE configurations on the same batch simultaneously, we amortize the I/O cost:</p>
<pre><code>┌────────────────────────┐
│ ViT Activations (disk) │
└───────────┬────────────┘
            │ (slow I/O, once per batch)
            ▼
      ┌──────────┐
      │  Batch   │
      └─────┬────┘
            ├─────────┬─────────┬─────────┐
            ▼         ▼         ▼         ▼
         SAE #1    SAE #2    SAE #3     ...
        (lr=3e-4) (lr=1e-3) (lr=3e-3)
</code></pre>
<h2 id="sweep-configuration">Sweep Configuration<a class="headerlink" href="#sweep-configuration" title="Permanent link">&para;</a></h2>
<h3 id="python-based-sweeps">Python-Based Sweeps<a class="headerlink" href="#python-based-sweeps" title="Permanent link">&para;</a></h3>
<p>Python sweeps give you full control over config generation. Your sweep file must define a <code>make_cfgs()</code> function that returns a list of dicts.</p>
<p><strong>Grid search example:</strong></p>
<pre><code class="language-python">def make_cfgs():
    cfgs = []

    for lr in [1e-4, 3e-4, 1e-3]:
        for exp_factor in [8, 16, 32]:
            cfg = {
                &quot;lr&quot;: lr,
                &quot;sae&quot;: {&quot;exp_factor&quot;: exp_factor},
            }
            cfgs.append(cfg)

    return cfgs
</code></pre>
<p><strong>Paired parameters (not a grid):</strong></p>
<pre><code class="language-python">def make_cfgs():
    cfgs = []

    # Grid over lr x sparsity
    for lr in [3e-4, 1e-3, 3e-3]:
        for sparsity in [4e-4, 8e-4, 1.6e-3]:
            # Paired layers (train and val use same layer)
            for layer in [6, 7, 8, 9, 10, 11]:
                cfg = {
                    &quot;lr&quot;: lr,
                    &quot;objective&quot;: {&quot;sparsity_coeff&quot;: sparsity},
                    &quot;train_data&quot;: {&quot;layer&quot;: layer},
                    &quot;val_data&quot;: {&quot;layer&quot;: layer},
                }
                cfgs.append(cfg)

    return cfgs
</code></pre>
<p>This generates 54 configs (3 x 3 x 6) where each train/val pair uses the same layer, avoiding the 162 configs you'd get from a full grid (3 x 3 x 6 x 6).</p>
<p><strong>Conditional sweeps:</strong></p>
<pre><code class="language-python">def make_cfgs():
    cfgs = []

    for exp_factor in [8, 16, 32]:
        # Use different LR for different expansion factors
        lrs = [1e-3, 3e-3] if exp_factor &lt;= 16 else [3e-4, 1e-3]

        for lr in lrs:
            cfg = {
                &quot;lr&quot;: lr,
                &quot;sae&quot;: {&quot;exp_factor&quot;: exp_factor},
            }
            cfgs.append(cfg)

    return cfgs
</code></pre>
<h2 id="command-line-overrides">Command-Line Overrides<a class="headerlink" href="#command-line-overrides" title="Permanent link">&para;</a></h2>
<p>Command-line arguments override sweep parameters with deep merging. The precedence order is: <strong>CLI &gt; Sweep &gt; Default</strong>.</p>
<pre><code class="language-bash">uv run train.py --sweep sweeps/my_sweep.py \
  --lr 5e-4  # Overrides all LRs in the sweep
</code></pre>
<p>Override nested config fields with dotted notation:</p>
<pre><code class="language-bash">uv run train.py --sweep sweeps/my_sweep.py \
  --train-data.layer 23 \
  --val-data.layer 23 \
  --sae.exp-factor 16
</code></pre>
<p>Deep merging means that when you override a nested field, only that specific field is replaced—other fields in the nested config are preserved from the sweep or default values.</p>
<h2 id="parallel-groups">Parallel Groups<a class="headerlink" href="#parallel-groups" title="Permanent link">&para;</a></h2>
<p>Not all parameters can vary within a parallel sweep. Parameters that affect data loading (like <code>train_data</code>, <code>n_train</code>, <code>device</code>) must be identical across all configs in a parallel group.</p>
<p>When configs differ in these parameters, they're automatically split into separate Slurm jobs:</p>
<pre><code class="language-python">def make_cfgs():
    cfgs = []

    # These will run in 2 separate jobs
    for layer in [6, 12]:  # Different data loading
        for lr in [1e-4, 3e-4]:  # Can parallelize
            cfg = {
                &quot;lr&quot;: lr,
                &quot;train_data&quot;: {&quot;layer&quot;: layer},
            }
            cfgs.append(cfg)

    return cfgs
</code></pre>
<p>This creates 2 parallel groups:
- Job 1: layer=6, lr=[1e-4, 3e-4]
- Job 2: layer=12, lr=[1e-4, 3e-4]</p>
<div class="admonition note">
<p class="admonition-title">Implementation detail</p>
<p>See <code>CANNOT_PARALLELIZE</code> in <code>train.py</code> for the full list of parameters that split parallel groups. The <code>split_cfgs()</code> function handles grouping automatically.</p>
</div>
<h2 id="module-loading">Module Loading<a class="headerlink" href="#module-loading" title="Permanent link">&para;</a></h2>
<p>Your sweep file is executed as a Python module, so you can use imports and helper functions:</p>
<pre><code class="language-python">def make_cfgs():
    cfgs = []

    # You can use helper functions
    base_layers = list(range(6, 24, 2))

    for layer in base_layers:
        for lr in [1e-4, 3e-4]:
            cfg = {
                &quot;lr&quot;: lr,
                &quot;train_data&quot;: {&quot;layer&quot;: layer, &quot;n_threads&quot;: 8},
                &quot;val_data&quot;: {&quot;layer&quot;: layer, &quot;n_threads&quot;: 8},
                &quot;sae&quot;: {&quot;exp_factor&quot;: 16, &quot;d_vit&quot;: 1024},
            }
            cfgs.append(cfg)

    return cfgs
</code></pre>
<div class="admonition note">
<p class="admonition-title">Import mechanics</p>
<p>The sweep file is loaded with <code>importlib.import_module()</code>, so it must be importable as a Python module. Place sweep files in a location where Python can find them (typically the project root or a <code>sweeps/</code> subdirectory).</p>
</div>
<h2 id="slurm-integration">Slurm Integration<a class="headerlink" href="#slurm-integration" title="Permanent link">&para;</a></h2>
<p>When running with <code>--slurm-acct</code>, each parallel group becomes a separate Slurm job:</p>
<pre><code class="language-bash">uv run train.py --sweep sweeps/large.py \
  --slurm-acct PAS2136 \
  --slurm-partition nextgen \
  --n-hours 24
</code></pre>
<p>The system automatically:
- Groups configs that can parallelize
- Submits one Slurm job per group
- Waits for all jobs to complete
- Reports results</p>
<h2 id="seed-management">Seed Management<a class="headerlink" href="#seed-management" title="Permanent link">&para;</a></h2>
<p>Seeds are automatically incremented for each config to ensure reproducibility:</p>
<pre><code class="language-python"># Base config has seed=42
# Sweep generates 9 configs with seeds: 42, 43, 44, ..., 50
</code></pre>
<p>Override the base seed on the command line:</p>
<pre><code class="language-bash">uv run train.py --sweep sweeps/my_sweep.py --seed 100
</code></pre>
<h2 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h2>
<p><strong>Simple grid:</strong></p>
<pre><code class="language-python"># sweeps/simple.py
def make_cfgs():
    return [
        {&quot;lr&quot;: lr, &quot;objective&quot;: {&quot;sparsity_coeff&quot;: sp}}
        for lr in [1e-4, 3e-4, 1e-3]
        for sp in [4e-4, 8e-4, 1.6e-3]
    ]
</code></pre>
<p><strong>Layer sweep with paired train/val:</strong></p>
<pre><code class="language-python"># sweeps/layers.py
def make_cfgs():
    cfgs = []

    for layer in range(6, 24, 2):  # Layers 6, 8, 10, ..., 22
        for lr in [3e-4, 1e-3]:
            cfg = {
                &quot;lr&quot;: lr,
                &quot;train_data&quot;: {&quot;layer&quot;: layer},
                &quot;val_data&quot;: {&quot;layer&quot;: layer},
            }
            cfgs.append(cfg)

    return cfgs
</code></pre>
<p><strong>Architecture sweep:</strong></p>
<pre><code class="language-python"># sweeps/architecture.py
def make_cfgs():
    cfgs = []

    architectures = [
        (&quot;small&quot;, 8, 1e-3),
        (&quot;medium&quot;, 16, 5e-4),
        (&quot;large&quot;, 32, 3e-4),
    ]

    for name, exp_factor, lr in architectures:
        cfg = {
            &quot;lr&quot;: lr,
            &quot;sae&quot;: {&quot;exp_factor&quot;: exp_factor},
            &quot;tag&quot;: name,
        }
        cfgs.append(cfg)

    return cfgs
</code></pre>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../glossary/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Glossary">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Glossary
              </div>
            </div>
          </a>
        
        
          
          <a href="../../developers/contributing/" class="md-footer__link md-footer__link--next" aria-label="Next: Contributing">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Contributing
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/OSU-NLP-Group/saev" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.path", "navigation.indexes", "navigation.expand", "toc.follow", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy", "navigation.footer", "content.action.edit"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>